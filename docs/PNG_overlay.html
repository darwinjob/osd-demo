
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>PNG overlay demo</title>
        
        <style>
          #openseadragon {
              position: absolute;
              top: 0;
              left: 0;
              bottom: 0;
              right: 0;
          }
        </style>
    </head>
    <body>
        <div id="openseadragon"></div>
        <script src='openseadragon.min.js'></script>
        <script src="openseadragon-filtering.js"></script>
        
        <script>
        
     // Yes, hardcoded for now.
        const dziWidth = 1;
        const dziHeight = 55305/47801;
        const diceWidth = 9561;
        const diceHeight = 11061;

        const scaleH = dziHeight / diceHeight;
        const scaleW = dziWidth / diceWidth;
        const overlayWidth = diceWidth * scaleW;
        const overlayHeight = diceHeight * scaleH;
        
        var img = document.createElement("img");
        img.id = "png-overlay"
        img.src = "https://raw.githubusercontent.com/darwinjob/osd-demo/master/resources/2877_NOP_tTA_lacZ_Xgal_resize_Simple_Seg_s028_alpha.png"        
        
        var viewer = OpenSeadragon({
        	id:              "openseadragon",
            prefixUrl:       "https://openseadragon.github.io/openseadragon/images/",
            tileSources:     "https://raw.githubusercontent.com/darwinjob/osd-demo/master/resources/2877_NOP_tTA_lacZ_Xgal_s028/2877_NOP_tTA_lacZ_Xgal_s028.dzi"
        });
        
        viewer.addOverlay({
       		element: img,
       		location: new OpenSeadragon.Rect((dziWidth - overlayWidth) / 2, (dziHeight - overlayHeight) / 2, overlayWidth, overlayHeight)
       	});
        var overlay = true;
        
    	var toggleButton = new OpenSeadragon.Button({
        	tooltip: 'Toggle overlay',
        	srcRest: 'https://openseadragon.github.io/openseadragon/images/button_rest.png',
        	srcGroup: 'https://openseadragon.github.io/openseadragon/images/button_grouphover.png',
        	srcHover: 'https://openseadragon.github.io/openseadragon/images/button_hover.png',
        	srcDown: 'https://openseadragon.github.io/openseadragon/images/button_pressed.png',
        	onClick: function toggleOverlay() {
        		if (overlay) {
        			viewer.removeOverlay("png-overlay");
       	        } else {
       	        	viewer.addOverlay({
       	        		element: img,
       	        		location: new OpenSeadragon.Rect((dziWidth - overlayWidth) / 2, (dziHeight - overlayHeight) / 2, overlayWidth, overlayHeight)
       	        	});
       	        }
        		overlay = !overlay;
       	    }
    	});
    	
    	viewer.addControl(toggleButton.element, { anchor: OpenSeadragon.ControlAnchor.TOP_LEFT });
   		
        </script>
    </body>
</html>
